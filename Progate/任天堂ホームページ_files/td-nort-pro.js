!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="SKjD")}({"5tEY":function(t,e,n){"use strict";e.a={constructorProps:{host:"tokyo.in.treasuredata.com",writeKey:"89/4a021ade2647ee61e82a10168aa72873a79d5bf3",database:"wt_ncl_prod_web",cdpHost:"cdp-tokyo.in.treasuredata.com",startInSignedMode:!0},tableName:"www_prod",tokenBanner:"3350ef0d-19ee-4e1e-84df-009c6bfe2f4b"}},SKjD:function(t,e,n){"use strict";n.r(e);var i=n("5tEY"),r=n("xJNa");Object(r.a)(i.a,!1)},xJNa:function(t,e,n){"use strict";var i=function(){var t={},e=document.cookie;if(""!==e)for(var n=e.split(";"),i=0;i<n.length;i++){var r=n[i].split("="),a=r[0].split(" ").join(""),s=r[1];t[a]=decodeURIComponent(s)}return t},r=function(){if(!(location.hostname.indexOf(".nintendo.co.jp")>=0)){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];console.log.apply(console,e)}};function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var s="df6dd232-b2af-4414-958d-37e7d4769e1a",o="fdd0cceb-e54e-4fbb-839d-1d0e9c9b143b",c={fetchUserOwnTitles:["/index.html","/software/switch/index.html","/software/3ds/index.html"],dontInitialTrackRT:["/software/feature/recommend.html"]},l=location.pathname.split("-tdtest").join("");l.indexOf(".html")<=0&&(l+="index.html");var u=function(){for(var t={},e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return n.forEach(function(e){for(var n in e)t[n]=e[n]}),t},d=function(){return JSON.parse(localStorage.getItem("alps/loginSession"))},f=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._config=e,this._td=new window.Treasure(this._config.constructorProps),this._rtEnabled=n,this._waitAlpsTryCount=0,this._waitAlpsTryMax="localhost"===location.hostname?0:3,this._waitAlps(this._ready.bind(this))}var e,n,f;return e=t,(n=[{key:"_waitAlps",value:function(t){this._waitAlpsTryCount++,this._waitAlpsTryCount>this._waitAlpsTryMax?t():d()?t():setTimeout(this._waitAlps.bind(this,t),2e3)}},{key:"_ready",value:function(){var t=this;this._makeBaseSendData(),this._trackInitialPage(function(){t._executeCallbacks()})}},{key:"_makeBaseSendData",value:function(){this._baseSendData={td_ip:"xxx",rt_uid:i()["_rt.uid"]},this._td.set("$global","td_global_id","td_global_id"),this._loginSession=d(),this._loginSession&&this._loginSession.isConnected&&(this._userData=JSON.parse(localStorage.getItem("alps/userData")),this._userData&&(this._naid=this._userData.id,"JP"===this._userData.country&&(this._baseSendData=u(this._baseSendData,{gender:this._userData.gender,country:this._userData.country,language:this._userData.language,emailoptin:this._userData.emailOptedIn,is_child:this._userData.isChild,naid:this._userData.id}))))}},{key:"_executeCallbacks",value:function(){var t=this;window.NCOMMON=window.NCOMMON||{},window.NCOMMON.tdCallbacks&&window.NCOMMON.tdCallbacks.forEach&&window.NCOMMON.tdCallbacks.forEach(function(e){return e(t)}),window.NCOMMON.tdCallbacks={push:function(e){e(t)}}}},{key:"_needFetchUserOwnTitles",value:function(){if(c.fetchUserOwnTitles.indexOf(l)<0)return r("[TDHelper] fetch user titles: skip - not target url"),!1;try{var t="td-fetch-user-own-titles";if(1===parseInt(window.sessionStorage.getItem(t)))return r("[TDHelper] fetch user titles: skip - fetched once"),!1;window.sessionStorage.setItem(t,1)}catch(t){return console.error("[TDHelper] fetch user titles: sessionStorage error",t),!1}return!0}},{key:"_trackInitialPage",value:function(t){var e=this;if(this._rtEnabled)if(this._loginSession&&this._loginSession.isConnected)if(this._userData){if(this._naid){var n=[this._config.tokenBanner];this._needFetchUserOwnTitles()&&(n.push(o),r("[TDHelper] fetch user own titles: do")),this._fetchUserSegments(n,function(n){if(n&&n.length>0){r("[TDHelper] Target segment",n);var i=(n[0].values||[]).join(",");if(c.dontInitialTrackRT.indexOf(l)>=0?r("[TDHelper] skip initial TD tracking"):e._trackTD({segment_ids:i}),n[1]){var a=(n[1].attributes.title_nsuids||[]).concat(n[1].attributes.aoc_nsuids||[]),s={};a.forEach(function(t,e){s["item".concat(e+1,"_code")]=t})}t()}else r("[TDHelper] No target segment"),e._trackTD(),t()},function(){e._trackTD(),t()})}}else this._trackTD(),t();else this._trackTD(),t();else this._trackTD(),t()}},{key:"_trackRT",value:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},{key:"_trackTD",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=u(this._baseSendData,t);r("[TDHelper] _trackTD",e),this._td.trackEvent(this._config.tableName,e)}},{key:"_fetchUserSegments",value:function(t,e,n){this._td.fetchUserSegments({audienceToken:t,keys:{naid:this._naid}},function(t){r("[TDHelper] _fetchUserSegments: Success",t),e&&e(t)},function(t){console.error("[TDHelper] _fetchUserSegments: Error",t),n&&n()})}},{key:"trackClick",value:function(t){t&&(""+t!==""+(t=parseInt(t))&&(t=""),r("[TDHelper] trackClick",t),this._trackTD({event:"click",productnsuid:t}),window.Rtoaster.init(window.RT_INIT_ID),window.Rtoaster.item(t))}},{key:"fetchRecomended",value:function(t){var e=this,n=[s];this._fetchUserSegments(n,function(n){try{var i=n[0].attributes.dt5_ns_uids;if(!i)return t(null);e._trackTD({recommended_nsuid:i.join(",")}),t(i)}catch(e){console.error("[TDHelper] segments parse error",e),t(null)}},function(){t(null)})}},{key:"fetchUserTitle",value:function(t){var e=this,n=[o];this._fetchUserSegments(n,function(n){try{var i=(n[0].attributes.title_nsuids||[]).concat(n[0].attributes.aoc_nsuids||[]);if(!i)return t(null);e._trackTD({usertitles_nsuid:i.join(",")}),t(i)}catch(e){console.error("[TDHelper] segments parse error",e),t(null)}},function(){t(null)})}}])&&a(e.prototype,n),f&&a(e,f),t}();e.a=function(t,e){!function(){(function(){!function(t,e){if(void 0===e[t]){e[t]=function(){e[t].clients.push(this),this._init=[Array.prototype.slice.call(arguments)]},e[t].clients=[];for(var n=function(t){return function(){return this["_"+t]=this["_"+t]||[],this["_"+t].push(Array.prototype.slice.call(arguments)),this}},i=["addRecord","fetchGlobalID","set","trackEvent","trackPageview","trackClicks","ready","fetchUserSegments"],r=0;r<i.length;r++){var a=i[r];e[t].prototype[a]=n(a)}var s=document.createElement("script");s.type="text/javascript",s.async=!0,s.src=("https:"===document.location.protocol?"https:":"http:")+"//cdn.treasuredata.com/sdk/2.1.0/td.min.js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(s,o)}}("Treasure",this)}).apply(window)}();!function n(){if(window.Treasure)return new f(t,e);setTimeout(n,300)}()}}});